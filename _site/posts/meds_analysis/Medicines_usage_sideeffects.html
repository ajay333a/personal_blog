<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ajay A">
<meta name="dcterms.date" content="2024-10-10">

<title>Medicines Side-effects and their Substitutes – Ajay Shankar A</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Ajay Shankar A</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">Ajay Shankar A</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ajay333a"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/ajay-shankar-a-4b0b121a1/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ajay333a"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Medicines Side-effects and their Substitutes</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">Analysis</div>
                <div class="quarto-category">Code</div>
                <div class="quarto-category">EDA</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Ajay A </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 10, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#importing-libraries" id="toc-importing-libraries" class="nav-link active" data-scroll-target="#importing-libraries"><span class="header-section-number">1</span> Importing Libraries</a></li>
  <li><a href="#importing-data" id="toc-importing-data" class="nav-link" data-scroll-target="#importing-data"><span class="header-section-number">2</span> Importing data</a>
  <ul class="collapse">
  <li><a href="#glancing-data" id="toc-glancing-data" class="nav-link" data-scroll-target="#glancing-data"><span class="header-section-number">2.1</span> Glancing data</a></li>
  </ul></li>
  <li><a href="#cleaning-the-data" id="toc-cleaning-the-data" class="nav-link" data-scroll-target="#cleaning-the-data"><span class="header-section-number">3</span> Cleaning the data</a>
  <ul class="collapse">
  <li><a href="#finding-nas-and-dulicates" id="toc-finding-nas-and-dulicates" class="nav-link" data-scroll-target="#finding-nas-and-dulicates"><span class="header-section-number">3.1</span> Finding <code>NA</code>s and Dulicates</a></li>
  <li><a href="#finding-unique-values" id="toc-finding-unique-values" class="nav-link" data-scroll-target="#finding-unique-values"><span class="header-section-number">3.2</span> Finding unique values</a></li>
  </ul></li>
  <li><a href="#data-manipulation" id="toc-data-manipulation" class="nav-link" data-scroll-target="#data-manipulation"><span class="header-section-number">4</span> Data Manipulation</a>
  <ul class="collapse">
  <li><a href="#pivoting-data" id="toc-pivoting-data" class="nav-link" data-scroll-target="#pivoting-data"><span class="header-section-number">4.1</span> Pivoting Data</a></li>
  </ul></li>
  <li><a href="#visualising-with-ggplot2" id="toc-visualising-with-ggplot2" class="nav-link" data-scroll-target="#visualising-with-ggplot2"><span class="header-section-number">5</span> Visualising with <code>ggplot2</code></a>
  <ul class="collapse">
  <li><a href="#bar-plots" id="toc-bar-plots" class="nav-link" data-scroll-target="#bar-plots"><span class="header-section-number">5.1</span> Bar plots</a></li>
  </ul></li>
  <li><a href="#finding-answers-to-specific-questions" id="toc-finding-answers-to-specific-questions" class="nav-link" data-scroll-target="#finding-answers-to-specific-questions"><span class="header-section-number">6</span> Finding Answers to Specific Questions</a>
  <ul class="collapse">
  <li><a href="#addictive-drugs" id="toc-addictive-drugs" class="nav-link" data-scroll-target="#addictive-drugs"><span class="header-section-number">6.1</span> Addictive drugs</a></li>
  <li><a href="#no-substitute-drugs" id="toc-no-substitute-drugs" class="nav-link" data-scroll-target="#no-substitute-drugs"><span class="header-section-number">6.2</span> No Substitute Drugs</a></li>
  <li><a href="#most-popular-drug-form" id="toc-most-popular-drug-form" class="nav-link" data-scroll-target="#most-popular-drug-form"><span class="header-section-number">6.3</span> Most Popular Drug form</a></li>
  <li><a href="#most-common-side-effects" id="toc-most-common-side-effects" class="nav-link" data-scroll-target="#most-common-side-effects"><span class="header-section-number">6.4</span> Most Common Side-Effects</a></li>
  <li><a href="#action-class-with-most-unique-side-effects" id="toc-action-class-with-most-unique-side-effects" class="nav-link" data-scroll-target="#action-class-with-most-unique-side-effects"><span class="header-section-number">6.5</span> Action class with most unique Side-effects</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>This dataset contains comprehensive information on over 248,000 medical drugs from all manufacturers available worldwide. The data includes details such as drug names, active ingredients, therapeutic uses, dosage, side effects, and substitutes. The dataset aims to provide a useful resource for medical researchers, healthcare professionals, and drug manufacturers.</p>
<section id="importing-libraries" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="importing-libraries"><span class="header-section-number">1</span> Importing Libraries</h2>
<p>For data manipulation and tidying up data <code>tidyverse</code> package in <code>R</code> has always been best. <code>tidyverse</code> is a collection of packages of <code>R</code> such as</p>
<ul>
<li><code>dplyr</code> and <code>tidyr</code> for manipulating data</li>
<li><code>ggplot2</code> for visualizing and rendering plots</li>
<li><code>lubridate</code> for dealing with dates and time series</li>
<li><code>forcats</code> for factoring of data</li>
<li><code>readr</code> for importing, reading, writing different file formats</li>
</ul>
<p>Lets import the libraries</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
</section>
<section id="importing-data" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="importing-data"><span class="header-section-number">2</span> Importing data</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>med_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"F:/r_language/quarto/blog/Data/250k Medicines Usage, Side Effects and Substitutes.csv"</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">guess_max =</span> <span class="dv">30000</span>) <span class="co">#guess_max function is used to correctly guess the type of the columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We imported the <code>.csv</code> file and we can see there are a total of <strong>248218 rows</strong> and <strong>58 columns</strong> in which 1 column is <code>integer(dbl)</code> 57 columns are classifies as <code>character(chr)</code> . The function <code>guess_max</code> makes sure that column type is identified correctly in the data.</p>
<section id="glancing-data" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="glancing-data"><span class="header-section-number">2.1</span> Glancing data</h3>
<p>Now lets take a sneak peek into the data.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>med_data <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 248,218
Columns: 58
$ id                  &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
$ name                &lt;chr&gt; "augmentin 625 duo tablet", "azithral 500 tablet",…
$ substitute0         &lt;chr&gt; "Penciclav 500 mg/125 mg Tablet", "Zithrocare 500m…
$ substitute1         &lt;chr&gt; "Moxikind-CV 625 Tablet", "Azax 500 Tablet", "Ambr…
$ substitute2         &lt;chr&gt; "Moxiforce-CV 625 Tablet", "Zady 500 Tablet", "Zer…
$ substitute3         &lt;chr&gt; "Fightox 625 Tablet", "Cazithro 500mg Tablet", "Ca…
$ substitute4         &lt;chr&gt; "Novamox CV 625mg Tablet", "Trulimax 500mg Tablet"…
$ sideEffect0         &lt;chr&gt; "Vomiting", "Vomiting", "Nausea", "Headache", "Sle…
$ sideEffect1         &lt;chr&gt; "Nausea", "Nausea", "Vomiting", "Drowsiness", "Dry…
$ sideEffect2         &lt;chr&gt; "Diarrhea", "Abdominal pain", "Diarrhea", "Dizzine…
$ sideEffect3         &lt;chr&gt; NA, "Diarrhea", "Upset stomach", "Nausea", NA, "Sk…
$ sideEffect4         &lt;chr&gt; NA, NA, "Stomach pain", NA, NA, "Flu-like symptoms…
$ sideEffect5         &lt;chr&gt; NA, NA, "Allergic reaction", NA, NA, "Headache", N…
$ sideEffect6         &lt;chr&gt; NA, NA, "Dizziness", NA, NA, "Drowsiness", NA, NA,…
$ sideEffect7         &lt;chr&gt; NA, NA, "Headache", NA, NA, "Dizziness", NA, NA, N…
$ sideEffect8         &lt;chr&gt; NA, NA, "Rash", NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect9         &lt;chr&gt; NA, NA, "Hives", NA, NA, NA, NA, NA, NA, NA, NA, N…
$ sideEffect10        &lt;chr&gt; NA, NA, "Tremors", NA, NA, NA, NA, NA, NA, NA, NA,…
$ sideEffect11        &lt;chr&gt; NA, NA, "Palpitations", NA, NA, NA, NA, NA, NA, NA…
$ sideEffect12        &lt;chr&gt; NA, NA, "Muscle cramp", NA, NA, NA, NA, NA, NA, NA…
$ sideEffect13        &lt;chr&gt; NA, NA, "Increased heart rate", NA, NA, NA, NA, NA…
$ sideEffect14        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect15        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect16        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect17        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect18        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect19        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect20        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect21        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect22        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect23        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect24        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect25        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect26        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect27        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect28        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect29        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect30        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect31        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect32        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect33        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect34        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect35        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect36        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect37        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect38        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect39        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect40        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sideEffect41        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ use0                &lt;chr&gt; "Treatment of Bacterial infections", "Treatment of…
$ use1                &lt;chr&gt; NA, NA, NA, "Treatment of Allergic conditions", NA…
$ use2                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ use3                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ use4                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `Chemical Class`    &lt;chr&gt; NA, "Macrolides", NA, "Diphenylmethane Derivative"…
$ `Habit Forming`     &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No", "N…
$ `Therapeutic Class` &lt;chr&gt; "ANTI INFECTIVES", "ANTI INFECTIVES", "RESPIRATORY…
$ `Action Class`      &lt;chr&gt; NA, "Macrolides", NA, "H1 Antihistaminics (second …</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finding rows and columns of data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>med_data <span class="sc">%&gt;%</span> <span class="fu">dim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 248218     58</code></pre>
</div>
</div>
<p>A total of <code>{r} nrow(med_data)</code> rows are present with <code>{r} ncol(med_data)</code> columns in which the</p>
<ul>
<li><code>id</code> is a number that can act as a primary key</li>
<li><code>name</code> is the name of the drugs. - <code>substitute0</code> to <code>substitue4</code> are alternate drugs to the drug in 2nd column that has the same use. - <code>sideEffect0</code> to <code>sideEffect41</code> are side-effects caused by the drug - <code>use0</code> to <code>use4</code> are what drug can be used to cure</li>
<li><code>Chemical Class</code> is the chemical group of the medicine</li>
<li><code>Habit Forming</code> is if a drug is addictive or not</li>
<li><code>Therapeutic Class</code> is about how a drug is intended to work</li>
<li><code>Action Class</code> is categorization a drug works in the system</li>
</ul>
</section>
</section>
<section id="cleaning-the-data" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="cleaning-the-data"><span class="header-section-number">3</span> Cleaning the data</h2>
<p>We can’t be sure that all the data in the columns is without any excess spaces and wrongly indented commas or brackets.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># converting all the columns of character to lower case letters</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>med_data <span class="ot">&lt;-</span> med_data <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span><span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, <span class="fu">tolower</span>(.x))) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is_character), <span class="sc">~</span><span class="fu">tolower</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is_character), <span class="sc">~</span><span class="fu">trimws</span>(.)))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># replacing all the '{' with '(' and '}' with ')'</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>med_data <span class="ot">&lt;-</span> med_data <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chemical_class =</span> <span class="fu">str_replace_all</span>(chemical_class, <span class="st">"</span><span class="sc">\\</span><span class="st">{"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">("</span>),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">chemical_class =</span> <span class="fu">str_replace_all</span>(chemical_class, <span class="st">"</span><span class="sc">\\</span><span class="st">}"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="finding-nas-and-dulicates" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="finding-nas-and-dulicates"><span class="header-section-number">3.1</span> Finding <code>NA</code>s and Dulicates</h3>
<p>Lets look at <code>NA</code>s in the data and the duplicates</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finding NA's in each columns</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>med_data <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               id              name       substitute0       substitute1 
                0                 0              9597             14351 
      substitute2       substitute3       substitute4       sideeffect0 
            17985             21362             24256                 0 
      sideeffect1       sideeffect2       sideeffect3       sideeffect4 
             9802             18718             40580             84658 
      sideeffect5       sideeffect6       sideeffect7       sideeffect8 
           116960            156361            180468            199712 
      sideeffect9      sideeffect10      sideeffect11      sideeffect12 
           210510            220944            227887            231936 
     sideeffect13      sideeffect14      sideeffect15      sideeffect16 
           233491            237799            240537            242209 
     sideeffect17      sideeffect18      sideeffect19      sideeffect20 
           242836            243703            244272            244995 
     sideeffect21      sideeffect22      sideeffect23      sideeffect24 
           245093            245170            245313            245495 
     sideeffect25      sideeffect26      sideeffect27      sideeffect28 
           246715            246715            246724            246724 
     sideeffect29      sideeffect30      sideeffect31      sideeffect32 
           246780            246889            246889            246890 
     sideeffect33      sideeffect34      sideeffect35      sideeffect36 
           247049            247052            248216            248216 
     sideeffect37      sideeffect38      sideeffect39      sideeffect40 
           248216            248216            248216            248216 
     sideeffect41              use0              use1              use2 
           248216                 0            174853            219911 
             use3              use4    chemical_class     habit_forming 
           240839            243247            110427                 0 
therapeutic_class      action_class 
               69            110182 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finding duplicates</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">duplicated</span>(med_data) <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>There are no duplicated values but there are so many <code>NA</code>s which is not helpful. Only 5 columns i.e., <code>id</code>, <code>name</code>, <code>sideEffect0</code>, <code>use0</code>, <code>Habit Forming</code> does not have any empty values in the column.</p>
</section>
<section id="finding-unique-values" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="finding-unique-values"><span class="header-section-number">3.2</span> Finding unique values</h3>
<p>Even though there no “NA”s in <code>id</code> and <code>name</code> of the drug lets make sure there are no duplicates</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># counting unique values in each column</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>med_data <span class="sc">%&gt;%</span> <span class="fu">map</span>(n_distinct) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               id              name       substitute0       substitute1 
           248218            222825             19374             16309 
      substitute2       substitute3       substitute4       sideeffect0 
            14289             12774             11689               326 
      sideeffect1       sideeffect2       sideeffect3       sideeffect4 
              335               352               363               359 
      sideeffect5       sideeffect6       sideeffect7       sideeffect8 
              325               299               275               254 
      sideeffect9      sideeffect10      sideeffect11      sideeffect12 
              232               212               182               174 
     sideeffect13      sideeffect14      sideeffect15      sideeffect16 
              145               121                95                78 
     sideeffect17      sideeffect18      sideeffect19      sideeffect20 
               66                52                42                36 
     sideeffect21      sideeffect22      sideeffect23      sideeffect24 
               30                25                18                14 
     sideeffect25      sideeffect26      sideeffect27      sideeffect28 
               11                11                10                10 
     sideeffect29      sideeffect30      sideeffect31      sideeffect32 
                9                 6                 6                 5 
     sideeffect33      sideeffect34      sideeffect35      sideeffect36 
                4                 3                 2                 2 
     sideeffect37      sideeffect38      sideeffect39      sideeffect40 
                2                 2                 2                 2 
     sideeffect41              use0              use1              use2 
                2               655               335               139 
             use3              use4    chemical_class     habit_forming 
               74                34               833                 2 
therapeutic_class      action_class 
               23               432 </code></pre>
</div>
</div>
<p>There over 2,48,218 <code>id</code>s but 222825 drug names are present at least 24000 names are repeated. Lets check which are repeated.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>duplicated_values <span class="ot">&lt;-</span> med_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>id) <span class="sc">%&gt;%</span> <span class="fu">duplicated</span>()</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>duplicated_values <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24204</code></pre>
</div>
</div>
<p>Lets remove duplicates from the datafame and create a dataset with unique values.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using filter function to remove duplicates</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>med_data_unique <span class="ot">&lt;-</span> med_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(<span class="fu">select</span>(., <span class="sc">-</span>id)))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(med_data_unique)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 224014     58</code></pre>
</div>
</div>
</section>
</section>
<section id="data-manipulation" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="data-manipulation"><span class="header-section-number">4</span> Data Manipulation</h2>
<section id="pivoting-data" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="pivoting-data"><span class="header-section-number">4.1</span> Pivoting Data</h3>
<p>For machines longer format data is much more readable and workable than wider format and we can drop <code>NA</code>s in the columns much more easily, without loosing data but it also comes at a cost while longer format data is easy for machines to read but very difficult for humans to comprehend and the number of rows can increase to very high numbers to a point that it’s not worth it.</p>
<p>We can pivot data and make the wide data format into narrow data format and make it more accessible to manipulate.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: pivoting_substitute_drug</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># pivoting data</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>med_data_sub <span class="ot">&lt;-</span> med_data_unique <span class="sc">%&gt;%</span> <span class="fu">select</span>(id<span class="sc">:</span>substitute4, use0<span class="sc">:</span>use4) <span class="sc">%&gt;%</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"substitute"</span>),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"sub_num"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"substitute_drug"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># counting NA's</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>med_data_sub <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             id            name            use0            use1            use2 
              0               0               0          786770          991525 
           use3            use4         sub_num substitute_drug 
        1086255         1097150               0           80639 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(med_data_sub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,120,070
Columns: 9
$ id              &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, …
$ name            &lt;chr&gt; "augmentin 625 duo tablet", "augmentin 625 duo tablet"…
$ use0            &lt;chr&gt; "treatment of bacterial infections", "treatment of bac…
$ use1            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ use2            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ use3            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ use4            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ sub_num         &lt;chr&gt; "substitute0", "substitute1", "substitute2", "substitu…
$ substitute_drug &lt;chr&gt; "penciclav 500 mg/125 mg tablet", "moxikind-cv 625 tab…</code></pre>
</div>
</div>
<p>As you can see the data only has 9 columns and 1241090 rows.</p>
<p>Now lets pivot the <code>use</code> of the drugs so that we can make the data more tidy which helps with removing of the duplicates and the <code>NA</code> values easily.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pivoting data </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>medi_use_pivot <span class="ot">&lt;-</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  med_data_sub <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>sub_num) <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"use"</span>),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"use_num"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"use"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>use_num) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(use))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># checking for NA values</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>medi_use_pivot <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             id            name substitute_drug             use 
              0               0          111133               0 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checking for duplicates</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>medi_use_pivot <span class="sc">%&gt;%</span> <span class="fu">duplicated</span>() <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 88192</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># removing duplicated data</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>med_use <span class="ot">&lt;-</span> medi_use_pivot <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(.))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># glimpse of data</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(med_use)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,550,458
Columns: 4
$ id              &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, …
$ name            &lt;chr&gt; "augmentin 625 duo tablet", "augmentin 625 duo tablet"…
$ substitute_drug &lt;chr&gt; "penciclav 500 mg/125 mg tablet", "moxikind-cv 625 tab…
$ use             &lt;chr&gt; "treatment of bacterial infections", "treatment of bac…</code></pre>
</div>
</div>
<p>We can use pivot method for <code>sideEffect</code>s to convert the data into a longer format. I am doing this case by case and not all in a single table because that would cause very long tables and a lot of <code>NA</code>s which would be hard to filter and we can join different tables using <code>*_join</code> functions with <code>id</code> column as it can act as a primary key.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pivoting data with side-effect columns</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>side_effect_med <span class="ot">&lt;-</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  med_data_unique <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, name, sideeffect0<span class="sc">:</span>sideeffect41) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"sideeffect"</span>),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"sideeffect_num"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"side_effects"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sideeffect_num)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># counting NA and duplicates</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>side_effect_med <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span> unlist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          id         name side_effects 
           0            0      7950288 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dropping NA's and duplicates</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>side_effect_med <span class="ot">&lt;-</span> side_effect_med <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(.))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># finding duplicates</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">duplicated</span>(side_effect_med) <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(side_effect_med)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,458,295
Columns: 3
$ id           &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, …
$ name         &lt;chr&gt; "augmentin 625 duo tablet", "augmentin 625 duo tablet", "…
$ side_effects &lt;chr&gt; "vomiting", "nausea", "diarrhea", "vomiting", "nausea", "…</code></pre>
</div>
</div>
<p>Now lets use pivoted data to plot graphs</p>
</section>
</section>
<section id="visualising-with-ggplot2" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="visualising-with-ggplot2"><span class="header-section-number">5</span> Visualising with <code>ggplot2</code></h2>
<p><code>ggplot2</code> is one of the most versatile packages I have come across for the purpose of visualizing using <strong>Grammar of Graphics</strong></p>
<section id="bar-plots" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="bar-plots"><span class="header-section-number">5.1</span> Bar plots</h3>
<p>Let’s find out and plot to which class most of the drugs in data belong to.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>chem_cl_top_10 <span class="ot">&lt;-</span>  </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  med_data_unique <span class="sc">%&gt;%</span> <span class="fu">select</span>(name, chemical_class) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(chemical_class) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"number_of_meds"</span> <span class="ot">=</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(number_of_meds, <span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(chemical_class <span class="sc">!=</span> <span class="st">"NA"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chemical_class =</span> <span class="fu">str_to_sentence</span>(chemical_class))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>chem_cl_top_10 <span class="sc">%&gt;%</span> </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(chemical_class, number_of_meds),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> number_of_meds)) <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> chemical_class)) <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chemical Class"</span>, <span class="at">y=</span> <span class="st">"Number of Medicines"</span>,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Most Common Chemical Class"</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Medicines_usage_sideeffects_files/figure-html/common_drug_classes-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Most common drug classes</figcaption>
</figure>
</div>
</div>
</div>
<p>By the graph we know that most of the drugs in data belong to the chemical class <code>{r} chem_cl_top_10[1,1]</code> with <code>{r} chem_cl_top_10[1,2]</code> drugs belong to that class, followed by <code>{r} chem_cl_top_10[2,1]</code> with <code>{r} chem_cl_top_10[2,2]</code> followed by <code>{r} chem_cl_top_10[3,1]</code>, <code>{r} chem_cl_top_10[4, 1]</code> and <code>{r} chem_cl_top_10[5, 1]</code>.</p>
<p>Now, that we have some basic idea of the data lets answer some questions</p>
</section>
</section>
<section id="finding-answers-to-specific-questions" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="finding-answers-to-specific-questions"><span class="header-section-number">6</span> Finding Answers to Specific Questions</h2>
<p>Now, that we have some basic idea of the data lets answer some questions</p>
<p>Lets begin with simple ones</p>
<section id="addictive-drugs" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="addictive-drugs"><span class="header-section-number">6.1</span> Addictive drugs</h3>
<p>Lets find the most addictive drugs in the data set and to which chemical class they belong to.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>habit_forming_classes <span class="ot">&lt;-</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  med_data_unique <span class="sc">%&gt;%</span> <span class="fu">filter</span>(habit_forming <span class="sc">==</span> <span class="st">"yes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, chemical_class) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(chemical_class, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>habit_forming_classes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 17 × 2
   chemical_class                                   n
   &lt;chr&gt;                                        &lt;int&gt;
 1 &lt;NA&gt;                                          2532
 2 benzodiazepines derivative                    2025
 3 anisole derivative                             365
 4 imidazopyridine derivative                     194
 5 benzodiazepine derivative                       83
 6 barbituric acid derivative                      55
 7 diphenylmethane derivative                      49
 8 cyclopyrrolone derivative                       28
 9 phenanthrenes derivatives                       26
10 phenanthrenes derivative                        22
11 aralkylamine derivative                         21
12 benzomorphan derivatives                        20
13 phenylpiperidine derivatives                    12
14 pyrazolopyrimidine derivative                   11
15 ultrashort-acting barbituric acid derivative    11
16 amphetamines derivatives                         6
17 phenylheptylamines derivative                    1</code></pre>
</div>
</div>
<p>We can see in the table that <code>{r} habit_forming_classes[1,2]</code> drugs which are addictive does not have their class mentioned, while <code>{r} habit_forming_classes[2,1]</code> have <code>{r} habit_forming_classes[2,2]</code> drugs which are habit forming.</p>
</section>
<section id="no-substitute-drugs" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="no-substitute-drugs"><span class="header-section-number">6.2</span> No Substitute Drugs</h3>
<p>Find the drugs with no substitute drugs, that have less side-effects, is not habit forming, and has many uses</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>med_data_unique <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># finding drugs with no sbustitute</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">if_all</span>(substitute0<span class="sc">:</span>substitute4, is.na) <span class="sc">&amp;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>         <span class="co"># medicine with no one side-effect</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">if_all</span>(sideeffect1<span class="sc">:</span>sideeffect41, is.na) <span class="sc">&amp;</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>           sideeffect0 <span class="sc">==</span> <span class="st">"no common side effects seen"</span> <span class="sc">&amp;</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Medicine with most uses</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>         <span class="fu">if_all</span>(use0<span class="sc">:</span>use2, <span class="sc">~!</span><span class="fu">is.na</span>(.)) <span class="sc">&amp;</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>         <span class="co"># not habit forming</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>         habit_forming <span class="sc">==</span> <span class="st">"no"</span> <span class="sc">&amp;</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Chemical Class, therapeutic class,action class is known</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(chemical_class) <span class="sc">&amp;</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(therapeutic_class) <span class="sc">&amp;</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(action_class)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 58
     id name         substitute0 substitute1 substitute2 substitute3 substitute4
  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;      
1 33940 bentoform d… &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;       
# ℹ 51 more variables: sideeffect0 &lt;chr&gt;, sideeffect1 &lt;chr&gt;, sideeffect2 &lt;chr&gt;,
#   sideeffect3 &lt;chr&gt;, sideeffect4 &lt;chr&gt;, sideeffect5 &lt;chr&gt;, sideeffect6 &lt;chr&gt;,
#   sideeffect7 &lt;chr&gt;, sideeffect8 &lt;chr&gt;, sideeffect9 &lt;chr&gt;,
#   sideeffect10 &lt;chr&gt;, sideeffect11 &lt;chr&gt;, sideeffect12 &lt;chr&gt;,
#   sideeffect13 &lt;chr&gt;, sideeffect14 &lt;chr&gt;, sideeffect15 &lt;chr&gt;,
#   sideeffect16 &lt;chr&gt;, sideeffect17 &lt;chr&gt;, sideeffect18 &lt;chr&gt;,
#   sideeffect19 &lt;chr&gt;, sideeffect20 &lt;chr&gt;, sideeffect21 &lt;chr&gt;, …</code></pre>
</div>
</div>
<p>Among the <code>{r} nrow(med_data_unique)</code> drugs only <strong>Betoform Dental Gel</strong> is the drug with No known side-effects, no alternate drugs, is not habit forming and has a known <em>Chemical Class</em>.</p>
</section>
<section id="most-popular-drug-form" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="most-popular-drug-form"><span class="header-section-number">6.3</span> Most Popular Drug form</h3>
<p>Lets find the most common type of form i.e, Tablet, Tonic, etc. in the data set.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>med_data_unique[<span class="dv">2</span>,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  name               
  &lt;chr&gt;              
1 azithral 500 tablet</code></pre>
</div>
</div>
<p>The medicine name in the end contains its form but it might not be true for all so lets do a string search so that the for is detected correctly in which it is sold or consumed if we extract it into a separate column we can know the most popular type.</p>
<p>Making a new dataframe by detecting strings of the column <code>name</code></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>med_form_df <span class="ot">&lt;-</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  med_data_unique <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">med_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># searching for specific type of medicine and making it a column</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"tablet"</span>) <span class="sc">~</span> <span class="st">"tablet"</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"capsule"</span>) <span class="sc">~</span> <span class="st">"capsule"</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"syrup"</span>) <span class="sc">~</span> <span class="st">"syrup"</span>,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"oral suspension"</span>) <span class="sc">~</span> <span class="st">"oral suspension"</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"suspension"</span>) <span class="sc">~</span> <span class="st">"suspension"</span>,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"cream|lotion"</span>) <span class="sc">~</span> <span class="st">"cream"</span>,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">".*gel"</span>) <span class="sc">~</span> <span class="st">"gel"</span>,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"drop|drops"</span>) <span class="sc">~</span> <span class="st">"drop"</span>,</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"bar|bars"</span>) <span class="sc">~</span> <span class="st">"bar"</span>,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"solution|solutions"</span>) <span class="sc">~</span> <span class="st">"solution"</span>,</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">".*cap|.*caps"</span>) <span class="sc">~</span> <span class="st">"caps"</span>,</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"infusion"</span>) <span class="sc">~</span> <span class="st">"infusion"</span>,</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"injection"</span>) <span class="sc">~</span> <span class="st">"injection"</span>,</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"granules"</span>) <span class="sc">~</span> <span class="st">"granules"</span>,</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"others"</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(med_type)) <span class="sc">%&gt;%</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(med_type, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>med_form_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 2
   med_type             n
   &lt;chr&gt;            &lt;int&gt;
 1 tablet          135267
 2 injection        26643
 3 capsule          18966
 4 syrup            16003
 5 drop              5508
 6 cream             5502
 7 others            5319
 8 oral suspension   4373
 9 suspension        2510
10 gel               1731
11 solution          1014
12 infusion           767
13 caps               275
14 granules            78
15 bar                 58</code></pre>
</div>
</div>
<p>As we can see that <strong><em>Tablets</em></strong> is the most common form with <code>{r} med_form_df[1,2]</code> followed by <strong><em>Injection</em></strong> with <code>{r} med_form_df[2,2]</code>, <strong><em>Capsules</em></strong> and <strong><em>Syrups</em></strong> take third and fourth place respectively.</p>
</section>
<section id="most-common-side-effects" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="most-common-side-effects"><span class="header-section-number">6.4</span> Most Common Side-Effects</h3>
<p>This is where pivoting data comes to the use, we cannot find the most common side-effect as there are 42 columns of them with NAs in the middle which gets complicated. By pivoting data to longer format we make each side-effect has its own row which leads to removal of NA easily.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>side_effect_med <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(side_effects <span class="sc">!=</span> <span class="st">"no common side effects seen"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(side_effects, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">side_effects =</span> <span class="fu">str_to_title</span>(side_effects)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(side_effects, n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> n)) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">number_format</span>(<span class="at">scale =</span> <span class="fl">1e-3</span>, <span class="at">suffix =</span> <span class="st">"K"</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Side-effects"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>, </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Most Common Side-effects"</span>) <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Medicines_usage_sideeffects_files/figure-html/common side-effects-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Most Common Side-effects</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="action-class-with-most-unique-side-effects" class="level3" data-number="6.5">
<h3 data-number="6.5" class="anchored" data-anchor-id="action-class-with-most-unique-side-effects"><span class="header-section-number">6.5</span> Action class with most unique Side-effects</h3>
<p>Lets find which <code>action_class</code> has most unique side-effects in the data</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>action_class_sideeffects <span class="ot">&lt;-</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  med_data_unique <span class="sc">%&gt;%</span> <span class="fu">select</span>(name, sideeffect0<span class="sc">:</span>sideeffect41,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                           action_class) <span class="sc">%&gt;%</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> sideeffect0<span class="sc">:</span>sideeffect41,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"sideeffect_num"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"side_effect"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># removing medicine name and sideeffect_num</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sideeffect_num, <span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># removing duplicates so that only unique side-effect &amp; action_class remain</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(.))</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>action_class_sideeffects <span class="sc">%&gt;%</span> <span class="fu">count</span>(action_class, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(<span class="at">n =</span> <span class="dv">10</span>, n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   action_class                        n
   &lt;chr&gt;                           &lt;int&gt;
 1 glucocorticoids                    88
 2 tyrosine kinase inhibitors         79
 3 vitamins                           73
 4 anticancer-others                  66
 5 antimetabolites                    66
 6 atypical antipsychotics            65
 7 sodium channel modulators (aed)    62
 8 alkaloids-cytotoxic agents         56
 9 alkylating agent                   53
10 quinolones/ fluroquinolones        53</code></pre>
</div>
</div>
<p>Drugs with <strong>Glucocorticoids</strong> have 88 unique side-effects, followed by <strong>Tyrosine Kinase Inhibitors</strong> with 79 , <strong>Vitamins</strong> and <strong>Anticancer-others</strong> come next.</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ajay333a\.quarto\.pub\/ajay333a");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb47" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Medicines Side-effects and their Substitutes"</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Ajay A"</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-10-10"</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: TRUE</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Analysis, Code, EDA]</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>This dataset contains comprehensive information on over 248,000 medical drugs from all manufacturers available worldwide. The data includes details such as drug names, active ingredients, therapeutic uses, dosage, side effects, and substitutes. The dataset aims to provide a useful resource for medical researchers, healthcare professionals, and drug manufacturers.</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="fu">## Importing Libraries</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>For data manipulation and tidying up data <span class="in">`tidyverse`</span> package in <span class="in">`R`</span> has always been best. <span class="in">`tidyverse`</span> is a collection of packages of <span class="in">`R`</span> such as</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`dplyr`</span> and <span class="in">`tidyr`</span> for manipulating data</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ggplot2`</span> for visualizing and rendering plots</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`lubridate`</span> for dealing with dates and time series</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`forcats`</span> for factoring of data</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`readr`</span> for importing, reading, writing different file formats</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>Lets import the libraries</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: loading libraries</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: true</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Importing data</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: importing data</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>med_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"F:/r_language/quarto/blog/Data/250k Medicines Usage, Side Effects and Substitutes.csv"</span>,</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">guess_max =</span> <span class="dv">30000</span>) <span class="co">#guess_max function is used to correctly guess the type of the columns</span></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>We imported the <span class="in">`.csv`</span> file and we can see there are a total of **248218 rows** and **58 columns** in which 1 column is <span class="in">`integer(dbl)`</span> 57 columns are classifies as <span class="in">`character(chr)`</span> . The function <span class="in">`guess_max`</span> makes sure that column type is identified correctly in the data.</span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a><span class="fu">### Glancing data</span></span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>Now lets take a sneak peek into the data.</span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: data sneakpeek</span></span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>med_data <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a><span class="co"># finding rows and columns of data</span></span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a>med_data <span class="sc">%&gt;%</span> <span class="fu">dim</span>()</span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a>A total of <span class="in">`{r} nrow(med_data)`</span> rows are present with <span class="in">`{r} ncol(med_data)`</span> columns in which the</span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`id`</span> is a number that can act as a primary key</span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`name`</span> is the name of the drugs. - <span class="in">`substitute0`</span> to <span class="in">`substitue4`</span> are alternate drugs to the drug in 2nd column that has the same use. - <span class="in">`sideEffect0`</span> to <span class="in">`sideEffect41`</span> are side-effects caused by the drug - <span class="in">`use0`</span> to <span class="in">`use4`</span> are what drug can be used to cure</span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Chemical Class`</span> is the chemical group of the medicine</span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Habit Forming`</span> is if a drug is addictive or not</span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Therapeutic Class`</span> is about how a drug is intended to work</span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Action Class`</span> is categorization a drug works in the system</span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cleaning the data</span></span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a>We can't be sure that all the data in the columns is without any excess spaces and wrongly indented commas or brackets.</span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lower casing the data</span></span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a><span class="co"># converting all the columns of character to lower case letters</span></span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a>med_data <span class="ot">&lt;-</span> med_data <span class="sc">%&gt;%</span></span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span><span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, <span class="fu">tolower</span>(.x))) <span class="sc">%&gt;%</span> </span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is_character), <span class="sc">~</span><span class="fu">tolower</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is_character), <span class="sc">~</span><span class="fu">trimws</span>(.)))</span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a><span class="co"># replacing all the '{' with '(' and '}' with ')'</span></span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a>med_data <span class="ot">&lt;-</span> med_data <span class="sc">%&gt;%</span> </span>
<span id="cb47-95"><a href="#cb47-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chemical_class =</span> <span class="fu">str_replace_all</span>(chemical_class, <span class="st">"</span><span class="sc">\\</span><span class="st">{"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">("</span>),</span>
<span id="cb47-96"><a href="#cb47-96" aria-hidden="true" tabindex="-1"></a>         <span class="at">chemical_class =</span> <span class="fu">str_replace_all</span>(chemical_class, <span class="st">"</span><span class="sc">\\</span><span class="st">}"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">)"</span>))</span>
<span id="cb47-97"><a href="#cb47-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-98"><a href="#cb47-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-99"><a href="#cb47-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-100"><a href="#cb47-100" aria-hidden="true" tabindex="-1"></a><span class="fu">### Finding `NA`s and Dulicates</span></span>
<span id="cb47-101"><a href="#cb47-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-102"><a href="#cb47-102" aria-hidden="true" tabindex="-1"></a>Lets look at <span class="in">`NA`</span>s in the data and the duplicates</span>
<span id="cb47-103"><a href="#cb47-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-106"><a href="#cb47-106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-107"><a href="#cb47-107" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: NA count and duplicates</span></span>
<span id="cb47-108"><a href="#cb47-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-109"><a href="#cb47-109" aria-hidden="true" tabindex="-1"></a><span class="co"># finding NA's in each columns</span></span>
<span id="cb47-110"><a href="#cb47-110" aria-hidden="true" tabindex="-1"></a>med_data <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb47-111"><a href="#cb47-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-112"><a href="#cb47-112" aria-hidden="true" tabindex="-1"></a><span class="co"># finding duplicates</span></span>
<span id="cb47-113"><a href="#cb47-113" aria-hidden="true" tabindex="-1"></a><span class="fu">duplicated</span>(med_data) <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span>
<span id="cb47-114"><a href="#cb47-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-115"><a href="#cb47-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-116"><a href="#cb47-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-117"><a href="#cb47-117" aria-hidden="true" tabindex="-1"></a>There are no duplicated values but there are so many <span class="in">`NA`</span>s which is not helpful. Only 5 columns i.e., <span class="in">`id`</span>, <span class="in">`name`</span>, <span class="in">`sideEffect0`</span>, <span class="in">`use0`</span>, <span class="in">`Habit Forming`</span> does not have any empty values in the column.</span>
<span id="cb47-118"><a href="#cb47-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-119"><a href="#cb47-119" aria-hidden="true" tabindex="-1"></a><span class="fu">### Finding unique values</span></span>
<span id="cb47-120"><a href="#cb47-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-121"><a href="#cb47-121" aria-hidden="true" tabindex="-1"></a>Even though there no "NA"s in <span class="in">`id`</span> and <span class="in">`name`</span> of the drug lets make sure there are no duplicates</span>
<span id="cb47-122"><a href="#cb47-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-125"><a href="#cb47-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-126"><a href="#cb47-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: counting distinct values</span></span>
<span id="cb47-127"><a href="#cb47-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-128"><a href="#cb47-128" aria-hidden="true" tabindex="-1"></a><span class="co"># counting unique values in each column</span></span>
<span id="cb47-129"><a href="#cb47-129" aria-hidden="true" tabindex="-1"></a>med_data <span class="sc">%&gt;%</span> <span class="fu">map</span>(n_distinct) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb47-130"><a href="#cb47-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-131"><a href="#cb47-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-132"><a href="#cb47-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-133"><a href="#cb47-133" aria-hidden="true" tabindex="-1"></a>There over 2,48,218 <span class="in">`id`</span>s but 222825 drug names are present at least 24000 names are repeated. Lets check which are repeated.</span>
<span id="cb47-134"><a href="#cb47-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-137"><a href="#cb47-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-138"><a href="#cb47-138" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: finding duplicate drugs</span></span>
<span id="cb47-139"><a href="#cb47-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-140"><a href="#cb47-140" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb47-141"><a href="#cb47-141" aria-hidden="true" tabindex="-1"></a>duplicated_values <span class="ot">&lt;-</span> med_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>id) <span class="sc">%&gt;%</span> <span class="fu">duplicated</span>()</span>
<span id="cb47-142"><a href="#cb47-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-143"><a href="#cb47-143" aria-hidden="true" tabindex="-1"></a>duplicated_values <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span>
<span id="cb47-144"><a href="#cb47-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-145"><a href="#cb47-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-146"><a href="#cb47-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-147"><a href="#cb47-147" aria-hidden="true" tabindex="-1"></a>Lets remove duplicates from the datafame and create a dataset with unique values.</span>
<span id="cb47-148"><a href="#cb47-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-151"><a href="#cb47-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-152"><a href="#cb47-152" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: removing duplicates</span></span>
<span id="cb47-153"><a href="#cb47-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-154"><a href="#cb47-154" aria-hidden="true" tabindex="-1"></a><span class="co"># using filter function to remove duplicates</span></span>
<span id="cb47-155"><a href="#cb47-155" aria-hidden="true" tabindex="-1"></a>med_data_unique <span class="ot">&lt;-</span> med_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(<span class="fu">select</span>(., <span class="sc">-</span>id)))</span>
<span id="cb47-156"><a href="#cb47-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-157"><a href="#cb47-157" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(med_data_unique)</span>
<span id="cb47-158"><a href="#cb47-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-159"><a href="#cb47-159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-160"><a href="#cb47-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-161"><a href="#cb47-161" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Manipulation</span></span>
<span id="cb47-162"><a href="#cb47-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-163"><a href="#cb47-163" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pivoting Data</span></span>
<span id="cb47-164"><a href="#cb47-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-165"><a href="#cb47-165" aria-hidden="true" tabindex="-1"></a>For machines longer format data is much more readable and workable than wider format and we can drop <span class="in">`NA`</span>s in the columns much more easily, without loosing data but it also comes at a cost while longer format data is easy for machines to read but very difficult for humans to comprehend and the number of rows can increase to very high numbers to a point that it's not worth it.</span>
<span id="cb47-166"><a href="#cb47-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-167"><a href="#cb47-167" aria-hidden="true" tabindex="-1"></a>We can pivot data and make the wide data format into narrow data format and make it more accessible to manipulate.</span>
<span id="cb47-168"><a href="#cb47-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-171"><a href="#cb47-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-172"><a href="#cb47-172" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: pivoting_substitute_drug</span></span>
<span id="cb47-173"><a href="#cb47-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-174"><a href="#cb47-174" aria-hidden="true" tabindex="-1"></a><span class="co"># pivoting data</span></span>
<span id="cb47-175"><a href="#cb47-175" aria-hidden="true" tabindex="-1"></a>med_data_sub <span class="ot">&lt;-</span> med_data_unique <span class="sc">%&gt;%</span> <span class="fu">select</span>(id<span class="sc">:</span>substitute4, use0<span class="sc">:</span>use4) <span class="sc">%&gt;%</span> </span>
<span id="cb47-176"><a href="#cb47-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"substitute"</span>),</span>
<span id="cb47-177"><a href="#cb47-177" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"sub_num"</span>,</span>
<span id="cb47-178"><a href="#cb47-178" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"substitute_drug"</span>)</span>
<span id="cb47-179"><a href="#cb47-179" aria-hidden="true" tabindex="-1"></a><span class="co"># counting NA's</span></span>
<span id="cb47-180"><a href="#cb47-180" aria-hidden="true" tabindex="-1"></a>med_data_sub <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb47-181"><a href="#cb47-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-182"><a href="#cb47-182" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(med_data_sub)</span>
<span id="cb47-183"><a href="#cb47-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-184"><a href="#cb47-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-185"><a href="#cb47-185" aria-hidden="true" tabindex="-1"></a>As you can see the data only has 9 columns and 1241090 rows.</span>
<span id="cb47-186"><a href="#cb47-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-187"><a href="#cb47-187" aria-hidden="true" tabindex="-1"></a>Now lets pivot the <span class="in">`use`</span> of the drugs so that we can make the data more tidy which helps with removing of the duplicates and the <span class="in">`NA`</span> values easily.</span>
<span id="cb47-188"><a href="#cb47-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-191"><a href="#cb47-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-192"><a href="#cb47-192" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pivoting_use</span></span>
<span id="cb47-193"><a href="#cb47-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-194"><a href="#cb47-194" aria-hidden="true" tabindex="-1"></a><span class="co"># pivoting data </span></span>
<span id="cb47-195"><a href="#cb47-195" aria-hidden="true" tabindex="-1"></a>medi_use_pivot <span class="ot">&lt;-</span> </span>
<span id="cb47-196"><a href="#cb47-196" aria-hidden="true" tabindex="-1"></a>  med_data_sub <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>sub_num) <span class="sc">%&gt;%</span> </span>
<span id="cb47-197"><a href="#cb47-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"use"</span>),</span>
<span id="cb47-198"><a href="#cb47-198" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"use_num"</span>,</span>
<span id="cb47-199"><a href="#cb47-199" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"use"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-200"><a href="#cb47-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>use_num) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(use))</span>
<span id="cb47-201"><a href="#cb47-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-202"><a href="#cb47-202" aria-hidden="true" tabindex="-1"></a><span class="co"># checking for NA values</span></span>
<span id="cb47-203"><a href="#cb47-203" aria-hidden="true" tabindex="-1"></a>medi_use_pivot <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb47-204"><a href="#cb47-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-205"><a href="#cb47-205" aria-hidden="true" tabindex="-1"></a><span class="co"># checking for duplicates</span></span>
<span id="cb47-206"><a href="#cb47-206" aria-hidden="true" tabindex="-1"></a>medi_use_pivot <span class="sc">%&gt;%</span> <span class="fu">duplicated</span>() <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span>
<span id="cb47-207"><a href="#cb47-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-208"><a href="#cb47-208" aria-hidden="true" tabindex="-1"></a><span class="co"># removing duplicated data</span></span>
<span id="cb47-209"><a href="#cb47-209" aria-hidden="true" tabindex="-1"></a>med_use <span class="ot">&lt;-</span> medi_use_pivot <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(.))</span>
<span id="cb47-210"><a href="#cb47-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-211"><a href="#cb47-211" aria-hidden="true" tabindex="-1"></a><span class="co"># glimpse of data</span></span>
<span id="cb47-212"><a href="#cb47-212" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(med_use)</span>
<span id="cb47-213"><a href="#cb47-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-214"><a href="#cb47-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-215"><a href="#cb47-215" aria-hidden="true" tabindex="-1"></a>We can use pivot method for <span class="in">`sideEffect`</span>s to convert the data into a longer format. I am doing this case by case and not all in a single table because that would cause very long tables and a lot of <span class="in">`NA`</span>s which would be hard to filter and we can join different tables using <span class="in">`*_join`</span> functions with <span class="in">`id`</span> column as it can act as a primary key.</span>
<span id="cb47-216"><a href="#cb47-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-219"><a href="#cb47-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-220"><a href="#cb47-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: side-effect_pivot</span></span>
<span id="cb47-221"><a href="#cb47-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-222"><a href="#cb47-222" aria-hidden="true" tabindex="-1"></a><span class="co"># pivoting data with side-effect columns</span></span>
<span id="cb47-223"><a href="#cb47-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-224"><a href="#cb47-224" aria-hidden="true" tabindex="-1"></a>side_effect_med <span class="ot">&lt;-</span> </span>
<span id="cb47-225"><a href="#cb47-225" aria-hidden="true" tabindex="-1"></a>  med_data_unique <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, name, sideeffect0<span class="sc">:</span>sideeffect41) <span class="sc">%&gt;%</span></span>
<span id="cb47-226"><a href="#cb47-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"sideeffect"</span>),</span>
<span id="cb47-227"><a href="#cb47-227" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"sideeffect_num"</span>,</span>
<span id="cb47-228"><a href="#cb47-228" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"side_effects"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-229"><a href="#cb47-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sideeffect_num)</span>
<span id="cb47-230"><a href="#cb47-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-231"><a href="#cb47-231" aria-hidden="true" tabindex="-1"></a><span class="co"># counting NA and duplicates</span></span>
<span id="cb47-232"><a href="#cb47-232" aria-hidden="true" tabindex="-1"></a>side_effect_med <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span> unlist</span>
<span id="cb47-233"><a href="#cb47-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-234"><a href="#cb47-234" aria-hidden="true" tabindex="-1"></a><span class="co"># dropping NA's and duplicates</span></span>
<span id="cb47-235"><a href="#cb47-235" aria-hidden="true" tabindex="-1"></a>side_effect_med <span class="ot">&lt;-</span> side_effect_med <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb47-236"><a href="#cb47-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(.))</span>
<span id="cb47-237"><a href="#cb47-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-238"><a href="#cb47-238" aria-hidden="true" tabindex="-1"></a><span class="co"># finding duplicates</span></span>
<span id="cb47-239"><a href="#cb47-239" aria-hidden="true" tabindex="-1"></a><span class="fu">duplicated</span>(side_effect_med) <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span>
<span id="cb47-240"><a href="#cb47-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-241"><a href="#cb47-241" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(side_effect_med)</span>
<span id="cb47-242"><a href="#cb47-242" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-243"><a href="#cb47-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-244"><a href="#cb47-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-245"><a href="#cb47-245" aria-hidden="true" tabindex="-1"></a>Now lets use pivoted data to plot graphs</span>
<span id="cb47-246"><a href="#cb47-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-247"><a href="#cb47-247" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualising with `ggplot2`</span></span>
<span id="cb47-248"><a href="#cb47-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-249"><a href="#cb47-249" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot2`</span> is one of the most versatile packages I have come across for the purpose of visualizing using **Grammar of Graphics**</span>
<span id="cb47-250"><a href="#cb47-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-251"><a href="#cb47-251" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bar plots</span></span>
<span id="cb47-252"><a href="#cb47-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-253"><a href="#cb47-253" aria-hidden="true" tabindex="-1"></a>Let's find out and plot to which class most of the drugs in data belong to.</span>
<span id="cb47-254"><a href="#cb47-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-257"><a href="#cb47-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-258"><a href="#cb47-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: common_drug_classes</span></span>
<span id="cb47-259"><a href="#cb47-259" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Most common drug classes</span></span>
<span id="cb47-260"><a href="#cb47-260" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb47-261"><a href="#cb47-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-262"><a href="#cb47-262" aria-hidden="true" tabindex="-1"></a>chem_cl_top_10 <span class="ot">&lt;-</span>  </span>
<span id="cb47-263"><a href="#cb47-263" aria-hidden="true" tabindex="-1"></a>  med_data_unique <span class="sc">%&gt;%</span> <span class="fu">select</span>(name, chemical_class) <span class="sc">%&gt;%</span> </span>
<span id="cb47-264"><a href="#cb47-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(chemical_class) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"number_of_meds"</span> <span class="ot">=</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb47-265"><a href="#cb47-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(number_of_meds, <span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-266"><a href="#cb47-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(chemical_class <span class="sc">!=</span> <span class="st">"NA"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-267"><a href="#cb47-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chemical_class =</span> <span class="fu">str_to_sentence</span>(chemical_class))</span>
<span id="cb47-268"><a href="#cb47-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-269"><a href="#cb47-269" aria-hidden="true" tabindex="-1"></a>chem_cl_top_10 <span class="sc">%&gt;%</span> </span>
<span id="cb47-270"><a href="#cb47-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(chemical_class, number_of_meds),</span>
<span id="cb47-271"><a href="#cb47-271" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> number_of_meds)) <span class="sc">+</span></span>
<span id="cb47-272"><a href="#cb47-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> chemical_class)) <span class="sc">+</span></span>
<span id="cb47-273"><a href="#cb47-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb47-274"><a href="#cb47-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb47-275"><a href="#cb47-275" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb47-276"><a href="#cb47-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chemical Class"</span>, <span class="at">y=</span> <span class="st">"Number of Medicines"</span>,</span>
<span id="cb47-277"><a href="#cb47-277" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Most Common Chemical Class"</span></span>
<span id="cb47-278"><a href="#cb47-278" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb47-279"><a href="#cb47-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb47-280"><a href="#cb47-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb47-281"><a href="#cb47-281" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-282"><a href="#cb47-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-283"><a href="#cb47-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-284"><a href="#cb47-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-285"><a href="#cb47-285" aria-hidden="true" tabindex="-1"></a>By the graph we know that most of the drugs in data belong to the chemical class <span class="in">`{r} chem_cl_top_10[1,1]`</span> with <span class="in">`{r} chem_cl_top_10[1,2]`</span> drugs belong to that class, followed by <span class="in">`{r} chem_cl_top_10[2,1]`</span> with <span class="in">`{r} chem_cl_top_10[2,2]`</span> followed by <span class="in">`{r} chem_cl_top_10[3,1]`</span>, <span class="in">`{r} chem_cl_top_10[4, 1]`</span> and <span class="in">`{r} chem_cl_top_10[5, 1]`</span>.</span>
<span id="cb47-286"><a href="#cb47-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-287"><a href="#cb47-287" aria-hidden="true" tabindex="-1"></a>Now, that we have some basic idea of the data lets answer some questions</span>
<span id="cb47-288"><a href="#cb47-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-289"><a href="#cb47-289" aria-hidden="true" tabindex="-1"></a><span class="fu">## Finding Answers to Specific Questions</span></span>
<span id="cb47-290"><a href="#cb47-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-291"><a href="#cb47-291" aria-hidden="true" tabindex="-1"></a>Now, that we have some basic idea of the data lets answer some questions</span>
<span id="cb47-292"><a href="#cb47-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-293"><a href="#cb47-293" aria-hidden="true" tabindex="-1"></a>Lets begin with simple ones</span>
<span id="cb47-294"><a href="#cb47-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-295"><a href="#cb47-295" aria-hidden="true" tabindex="-1"></a><span class="fu">### Addictive drugs</span></span>
<span id="cb47-296"><a href="#cb47-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-297"><a href="#cb47-297" aria-hidden="true" tabindex="-1"></a>Lets find the most addictive drugs in the data set and to which chemical class they belong to.</span>
<span id="cb47-298"><a href="#cb47-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-301"><a href="#cb47-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-302"><a href="#cb47-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: addictive drugs</span></span>
<span id="cb47-303"><a href="#cb47-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-304"><a href="#cb47-304" aria-hidden="true" tabindex="-1"></a>habit_forming_classes <span class="ot">&lt;-</span> </span>
<span id="cb47-305"><a href="#cb47-305" aria-hidden="true" tabindex="-1"></a>  med_data_unique <span class="sc">%&gt;%</span> <span class="fu">filter</span>(habit_forming <span class="sc">==</span> <span class="st">"yes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-306"><a href="#cb47-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, chemical_class) <span class="sc">%&gt;%</span></span>
<span id="cb47-307"><a href="#cb47-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(chemical_class, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-308"><a href="#cb47-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-309"><a href="#cb47-309" aria-hidden="true" tabindex="-1"></a>habit_forming_classes</span>
<span id="cb47-310"><a href="#cb47-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-311"><a href="#cb47-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-312"><a href="#cb47-312" aria-hidden="true" tabindex="-1"></a>We can see in the table that <span class="in">`{r} habit_forming_classes[1,2]`</span> drugs which are addictive does not have their class mentioned, while <span class="in">`{r} habit_forming_classes[2,1]`</span> have <span class="in">`{r} habit_forming_classes[2,2]`</span> drugs which are habit forming.</span>
<span id="cb47-313"><a href="#cb47-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-314"><a href="#cb47-314" aria-hidden="true" tabindex="-1"></a><span class="fu">### No Substitute Drugs</span></span>
<span id="cb47-315"><a href="#cb47-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-316"><a href="#cb47-316" aria-hidden="true" tabindex="-1"></a>Find the drugs with no substitute drugs, that have less side-effects, is not habit forming, and has many uses</span>
<span id="cb47-317"><a href="#cb47-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-320"><a href="#cb47-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-321"><a href="#cb47-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: no substitute drug</span></span>
<span id="cb47-322"><a href="#cb47-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-323"><a href="#cb47-323" aria-hidden="true" tabindex="-1"></a>med_data_unique <span class="sc">%&gt;%</span></span>
<span id="cb47-324"><a href="#cb47-324" aria-hidden="true" tabindex="-1"></a>  <span class="co"># finding drugs with no sbustitute</span></span>
<span id="cb47-325"><a href="#cb47-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">if_all</span>(substitute0<span class="sc">:</span>substitute4, is.na) <span class="sc">&amp;</span></span>
<span id="cb47-326"><a href="#cb47-326" aria-hidden="true" tabindex="-1"></a>         <span class="co"># medicine with no one side-effect</span></span>
<span id="cb47-327"><a href="#cb47-327" aria-hidden="true" tabindex="-1"></a>         <span class="fu">if_all</span>(sideeffect1<span class="sc">:</span>sideeffect41, is.na) <span class="sc">&amp;</span></span>
<span id="cb47-328"><a href="#cb47-328" aria-hidden="true" tabindex="-1"></a>           sideeffect0 <span class="sc">==</span> <span class="st">"no common side effects seen"</span> <span class="sc">&amp;</span></span>
<span id="cb47-329"><a href="#cb47-329" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Medicine with most uses</span></span>
<span id="cb47-330"><a href="#cb47-330" aria-hidden="true" tabindex="-1"></a>         <span class="fu">if_all</span>(use0<span class="sc">:</span>use2, <span class="sc">~!</span><span class="fu">is.na</span>(.)) <span class="sc">&amp;</span></span>
<span id="cb47-331"><a href="#cb47-331" aria-hidden="true" tabindex="-1"></a>         <span class="co"># not habit forming</span></span>
<span id="cb47-332"><a href="#cb47-332" aria-hidden="true" tabindex="-1"></a>         habit_forming <span class="sc">==</span> <span class="st">"no"</span> <span class="sc">&amp;</span></span>
<span id="cb47-333"><a href="#cb47-333" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Chemical Class, therapeutic class,action class is known</span></span>
<span id="cb47-334"><a href="#cb47-334" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(chemical_class) <span class="sc">&amp;</span></span>
<span id="cb47-335"><a href="#cb47-335" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(therapeutic_class) <span class="sc">&amp;</span></span>
<span id="cb47-336"><a href="#cb47-336" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(action_class)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-337"><a href="#cb47-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb47-338"><a href="#cb47-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-339"><a href="#cb47-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-340"><a href="#cb47-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-341"><a href="#cb47-341" aria-hidden="true" tabindex="-1"></a>Among the <span class="in">`{r} nrow(med_data_unique)`</span> drugs only **Betoform Dental Gel** is the drug with No known side-effects, no alternate drugs, is not habit forming and has a known *Chemical Class*.</span>
<span id="cb47-342"><a href="#cb47-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-343"><a href="#cb47-343" aria-hidden="true" tabindex="-1"></a><span class="fu">### Most Popular Drug form</span></span>
<span id="cb47-344"><a href="#cb47-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-345"><a href="#cb47-345" aria-hidden="true" tabindex="-1"></a>Lets find the most common type of form i.e, Tablet, Tonic, etc. in the data set.</span>
<span id="cb47-346"><a href="#cb47-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-349"><a href="#cb47-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-350"><a href="#cb47-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: medicine name</span></span>
<span id="cb47-351"><a href="#cb47-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-352"><a href="#cb47-352" aria-hidden="true" tabindex="-1"></a>med_data_unique[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb47-353"><a href="#cb47-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-354"><a href="#cb47-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-355"><a href="#cb47-355" aria-hidden="true" tabindex="-1"></a>The medicine name in the end contains its form but it might not be true for all so lets do a string search so that the for is detected correctly in which it is sold or consumed if we extract it into a separate column we can know the most popular type.</span>
<span id="cb47-356"><a href="#cb47-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-357"><a href="#cb47-357" aria-hidden="true" tabindex="-1"></a>Making a new dataframe by detecting strings of the column <span class="in">`name`</span></span>
<span id="cb47-358"><a href="#cb47-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-361"><a href="#cb47-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-362"><a href="#cb47-362" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: medicine form</span></span>
<span id="cb47-363"><a href="#cb47-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-364"><a href="#cb47-364" aria-hidden="true" tabindex="-1"></a>med_form_df <span class="ot">&lt;-</span> </span>
<span id="cb47-365"><a href="#cb47-365" aria-hidden="true" tabindex="-1"></a>  med_data_unique <span class="sc">%&gt;%</span></span>
<span id="cb47-366"><a href="#cb47-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb47-367"><a href="#cb47-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">med_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb47-368"><a href="#cb47-368" aria-hidden="true" tabindex="-1"></a>    <span class="co"># searching for specific type of medicine and making it a column</span></span>
<span id="cb47-369"><a href="#cb47-369" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"tablet"</span>) <span class="sc">~</span> <span class="st">"tablet"</span>,</span>
<span id="cb47-370"><a href="#cb47-370" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"capsule"</span>) <span class="sc">~</span> <span class="st">"capsule"</span>,</span>
<span id="cb47-371"><a href="#cb47-371" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"syrup"</span>) <span class="sc">~</span> <span class="st">"syrup"</span>,</span>
<span id="cb47-372"><a href="#cb47-372" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"oral suspension"</span>) <span class="sc">~</span> <span class="st">"oral suspension"</span>,</span>
<span id="cb47-373"><a href="#cb47-373" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"suspension"</span>) <span class="sc">~</span> <span class="st">"suspension"</span>,</span>
<span id="cb47-374"><a href="#cb47-374" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"cream|lotion"</span>) <span class="sc">~</span> <span class="st">"cream"</span>,</span>
<span id="cb47-375"><a href="#cb47-375" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">".*gel"</span>) <span class="sc">~</span> <span class="st">"gel"</span>,</span>
<span id="cb47-376"><a href="#cb47-376" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"drop|drops"</span>) <span class="sc">~</span> <span class="st">"drop"</span>,</span>
<span id="cb47-377"><a href="#cb47-377" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"bar|bars"</span>) <span class="sc">~</span> <span class="st">"bar"</span>,</span>
<span id="cb47-378"><a href="#cb47-378" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"solution|solutions"</span>) <span class="sc">~</span> <span class="st">"solution"</span>,</span>
<span id="cb47-379"><a href="#cb47-379" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">".*cap|.*caps"</span>) <span class="sc">~</span> <span class="st">"caps"</span>,</span>
<span id="cb47-380"><a href="#cb47-380" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"infusion"</span>) <span class="sc">~</span> <span class="st">"infusion"</span>,</span>
<span id="cb47-381"><a href="#cb47-381" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"injection"</span>) <span class="sc">~</span> <span class="st">"injection"</span>,</span>
<span id="cb47-382"><a href="#cb47-382" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="st">"granules"</span>) <span class="sc">~</span> <span class="st">"granules"</span>,</span>
<span id="cb47-383"><a href="#cb47-383" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"others"</span></span>
<span id="cb47-384"><a href="#cb47-384" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb47-385"><a href="#cb47-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(med_type)) <span class="sc">%&gt;%</span></span>
<span id="cb47-386"><a href="#cb47-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(med_type, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-387"><a href="#cb47-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-388"><a href="#cb47-388" aria-hidden="true" tabindex="-1"></a>med_form_df</span>
<span id="cb47-389"><a href="#cb47-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-390"><a href="#cb47-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-391"><a href="#cb47-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-392"><a href="#cb47-392" aria-hidden="true" tabindex="-1"></a>As we can see that ***Tablets*** is the most common form with `{r} med_form_df[1,2]` followed by ***Injection*** with `{r} med_form_df[2,2]`, ***Capsules*** and ***Syrups*** take third and fourth place respectively.</span>
<span id="cb47-393"><a href="#cb47-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-394"><a href="#cb47-394" aria-hidden="true" tabindex="-1"></a><span class="fu">### Most Common Side-Effects</span></span>
<span id="cb47-395"><a href="#cb47-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-396"><a href="#cb47-396" aria-hidden="true" tabindex="-1"></a>This is where pivoting data comes to the use, we cannot find the most common side-effect as there are 42 columns of them with NAs in the middle which gets complicated. By pivoting data to longer format we make each side-effect has its own row which leads to removal of NA easily.</span>
<span id="cb47-397"><a href="#cb47-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-400"><a href="#cb47-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-401"><a href="#cb47-401" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: common side-effects</span></span>
<span id="cb47-402"><a href="#cb47-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Most Common Side-effects</span></span>
<span id="cb47-403"><a href="#cb47-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb47-404"><a href="#cb47-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-405"><a href="#cb47-405" aria-hidden="true" tabindex="-1"></a>side_effect_med <span class="sc">%&gt;%</span> </span>
<span id="cb47-406"><a href="#cb47-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(side_effects <span class="sc">!=</span> <span class="st">"no common side effects seen"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-407"><a href="#cb47-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(side_effects, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb47-408"><a href="#cb47-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-409"><a href="#cb47-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">side_effects =</span> <span class="fu">str_to_title</span>(side_effects)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-410"><a href="#cb47-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(side_effects, n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb47-411"><a href="#cb47-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> n)) <span class="sc">+</span></span>
<span id="cb47-412"><a href="#cb47-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb47-413"><a href="#cb47-413" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">number_format</span>(<span class="at">scale =</span> <span class="fl">1e-3</span>, <span class="at">suffix =</span> <span class="st">"K"</span>)</span>
<span id="cb47-414"><a href="#cb47-414" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-415"><a href="#cb47-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Side-effects"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>, </span>
<span id="cb47-416"><a href="#cb47-416" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Most Common Side-effects"</span>) <span class="sc">+</span></span>
<span id="cb47-417"><a href="#cb47-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb47-418"><a href="#cb47-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-419"><a href="#cb47-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-420"><a href="#cb47-420" aria-hidden="true" tabindex="-1"></a><span class="fu">### Action class with most unique Side-effects</span></span>
<span id="cb47-421"><a href="#cb47-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-422"><a href="#cb47-422" aria-hidden="true" tabindex="-1"></a>Lets find which <span class="in">`action_class`</span> has most unique side-effects in the data</span>
<span id="cb47-423"><a href="#cb47-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-426"><a href="#cb47-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-427"><a href="#cb47-427" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: action_class side-effects</span></span>
<span id="cb47-428"><a href="#cb47-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-429"><a href="#cb47-429" aria-hidden="true" tabindex="-1"></a>action_class_sideeffects <span class="ot">&lt;-</span></span>
<span id="cb47-430"><a href="#cb47-430" aria-hidden="true" tabindex="-1"></a>  med_data_unique <span class="sc">%&gt;%</span> <span class="fu">select</span>(name, sideeffect0<span class="sc">:</span>sideeffect41,</span>
<span id="cb47-431"><a href="#cb47-431" aria-hidden="true" tabindex="-1"></a>                           action_class) <span class="sc">%&gt;%</span> </span>
<span id="cb47-432"><a href="#cb47-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> sideeffect0<span class="sc">:</span>sideeffect41,</span>
<span id="cb47-433"><a href="#cb47-433" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"sideeffect_num"</span>,</span>
<span id="cb47-434"><a href="#cb47-434" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"side_effect"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-435"><a href="#cb47-435" aria-hidden="true" tabindex="-1"></a>  <span class="co"># removing medicine name and sideeffect_num</span></span>
<span id="cb47-436"><a href="#cb47-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sideeffect_num, <span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb47-437"><a href="#cb47-437" aria-hidden="true" tabindex="-1"></a>  <span class="co"># removing duplicates so that only unique side-effect &amp; action_class remain</span></span>
<span id="cb47-438"><a href="#cb47-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(.))</span>
<span id="cb47-439"><a href="#cb47-439" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-440"><a href="#cb47-440" aria-hidden="true" tabindex="-1"></a>action_class_sideeffects <span class="sc">%&gt;%</span> <span class="fu">count</span>(action_class, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-441"><a href="#cb47-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(<span class="at">n =</span> <span class="dv">10</span>, n)</span>
<span id="cb47-442"><a href="#cb47-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-443"><a href="#cb47-443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-444"><a href="#cb47-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-445"><a href="#cb47-445" aria-hidden="true" tabindex="-1"></a>Drugs with **Glucocorticoids** have 88 unique side-effects, followed by **Tyrosine Kinase Inhibitors** with 79 , **Vitamins** and **Anticancer-others** come next.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>